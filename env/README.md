structure from https://github.com/oxwhirl/smac